<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Apache::Request</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>Apache::Request<br>
<small>
[<a class="el" href="group__XS.html">Perl</a>]</small>
</h1><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
</table>


<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#apache::request_methods">Apache::Request METHODS</a></li>
	<ul>

		<li><a href="#new">new</a></li>
		<li><a href="#param">param</a></li>
		<li><a href="#parms,_params">parms, params</a></li>
		<li><a href="#args">args</a></li>
		<li><a href="#body">body</a></li>
		<li><a href="#upload">upload</a></li>
	</ul>

	<li><a href="#subclassing_apache::request">SUBCLASSING Apache::Request</a></li>
	<li><a href="#apache::upload_methods">Apache::Upload METHODS</a></li>
	<ul>

		<li><a href="#name">name</a></li>
		<li><a href="#filename">filename</a></li>
		<li><a href="#bb_[replaces_fh]">bb [replaces fh]</a></li>
		<li><a href="#size_[todo]">size [TODO]</a></li>
		<li><a href="#info">info</a></li>
		<li><a href="#type_[todo]">type [TODO]</a></li>
		<li><a href="#tempname_[xxx_does_this_mesh_with_brigade_api]">tempname [XXX- Does this mesh with brigade API?]</a></li>
		<li><a href="#link">link</a></li>
	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#credits">CREDITS</a></li>
	<li><a href="#authors">AUTHORS</a></li>
	<li><a href="#missing_docs">MISSING DOCS</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Apache::Request - Methods for dealing with client request data</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
    use Apache::Request;
    my $req = Apache::Request-&gt;new($r);</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p><em>Apache::Request</em> adds methods for parsing <strong>GET</strong> requests and <strong>POST</strong> 
requests where <em>Content-type</em> is one of <em>application/x-www-form-urlencoded</em> or 
<em>multipart/form-data</em>.</p>
<p>
</p>
<hr />
<h1><a name="apache::request_methods">Apache::Request METHODS</a></h1>
<p>The interface is designed to mimic CGI.pm 's routines for parsing
query parameters. The main differences are</p>
<ul>
<li><strong><a name="item_as"><code>Apache::Request::new</code> takes an environment-specific
object as (second) argument.</a></strong><br />
</li>
<li><strong><a name="item_the_query_parameters_are_stored_as_apache%3a%3atab">The query parameters are stored as Apache::Table objects,
and are therefore parsed using case-insensitive keys.</a></strong><br />
</li>
<li><strong><a name="item_the_query_string_is_always_parsed%2c_even_for_post">The query string is always parsed, even for POST requests.</a></strong><br />
</li>
</ul>
<p>
</p>
<h2><a name="new">new</a></h2>
<p>creates a new <em>Apache::Request</em> object with an environment object $r:</p>
<pre>
    my $req = Apache::Request-&gt;new($r);</pre>
<p>With mod_perl2, the environment object must be an <em>Apache::RequestRec</em>
object.  All methods from the environment class are inherited.</p>
<p>The following attributes are optional:</p>
<dl>
<dt><strong><a name="item_post_max">POST_MAX</a></strong><br />
</dt>
<dd>
Limit the size of POST data (in bytes).
</dd>
<p></p>
<dt><strong><a name="item_disable_uploads">DISABLE_UPLOADS</a></strong><br />
</dt>
<dd>
Disable file uploads.
</dd>
<p></p>
<dt><strong><a name="item_temp_dir">TEMP_DIR</a></strong><br />
</dt>
<dd>
Sets the directory where upload files are spooled.  On a *nix-like
that supports link(2), the TEMP_DIR should be located on the same
file system as the final destination file:
</dd>
<dd>
<pre>
 my $req = Apache::Request-&gt;new($r, TEMP_DIR =&gt; &quot;/home/httpd/tmp&quot;);
 my $upload = $req-&gt;upload('file');
 $upload-&gt;link(&quot;/home/user/myfile&quot;) || warn &quot;link failed: $!&quot;;</pre>
</dd>
<p></p>
<dt><strong><a name="item_hook_data_%5btodo%5d">HOOK_DATA [TODO]</a></strong><br />
</dt>
<dd>
Extra configuration info passed to an upload hook.
See the description for the next item, <em>UPLOAD_HOOK</em>.
</dd>
<p></p>
<dt><strong><a name="item_upload_hook_%5btodo%5d">UPLOAD_HOOK [TODO]</a></strong><br />
</dt>
<dd>
Sets up a callback to run whenever file upload data is read. This
can be used to provide an upload progress meter during file uploads.
Apache will automatically continue writing the original data to
$upload-&gt;fh after the hook exits.
</dd>
<dd>
<pre>
 my $transparent_hook = sub {
   my ($upload, $buf, $len, $hook_data) = @_;
   warn &quot;$hook_data: got $len bytes for &quot; . $upload-&gt;name;
 };</pre>
</dd>
<dd>
<pre>
 my $apr = Apache::Request-&gt;new($r, 
                                HOOK_DATA =&gt; &quot;Note&quot;,
                                UPLOAD_HOOK =&gt; $transparent_hook,
                               );</pre>
</dd>
<p></p></dl>
<p>
</p>
<h2><a name="param">param</a></h2>
<p>Get or set (TODO) the request parameters (using case-insensitive keys) by
mimicing the OO interface of <code>CGI::param</code>.</p>
<pre>
    # similar to CGI.pm</pre>
<pre>
    my $value = $req-&gt;param('foo');
    my @values = $req-&gt;param('foo');
    my @params = $req-&gt;param;</pre>
<pre>
    # the following differ slightly from CGI.pm</pre>
<pre>
    # assigns multiple values to 'foo'
    $req-&gt;param('foo' =&gt; [qw(one two three)]); # TODO</pre>
<pre>
    # returns ref to underlying apache table object
    my $table = $req-&gt;param; # identical to $apr-&gt;parms - see below</pre>
<p>
</p>
<h2><a name="parms,_params">parms, params</a></h2>
<p>Get the full parameter table of the <em>Apache::Request</em> object.</p>
<pre>
   # returns ref to Apache::Request::Table object provided by $apache_table
   my $table = $req-&gt;parms;</pre>
<p>An optional name parameter can be passed to return the parameter
associated with the given name:</p>
<pre>
   my $param = $req-&gt;parms($name);</pre>
<p>
</p>
<h2><a name="args">args</a></h2>
<p>Returns an <em>Apache::Request::Table</em> object containing the query-string 
parameters of the <em>Apache::Request</em> object.</p>
<pre>
   my $args = $req-&gt;args;</pre>
<p>An optional name parameter can be passed to return the query string
parameter associated with the given name:</p>
<pre>
   my $arg = $req-&gt;args($name);</pre>
<p>
</p>
<h2><a name="body">body</a></h2>
<p>Returns an <em>Apache::Request::Table</em> object containing the POST data 
parameters of the <em>Apache::Request</em> object.</p>
<pre>
   my $body = $req-&gt;body;</pre>
<p>An optional name parameter can be passed to return the POST data
parameter associated with the given name:</p>
<pre>
   my $param = $req-&gt;body($name);</pre>
<p>
</p>
<h2><a name="upload">upload</a></h2>
<p>With no arguments, this returns an <em>Apache::Upload::Table</em> object in 
scalar context, or the names of all <em>Apache::Upload</em> objects in
list context.</p>
<p>An optional name parameter can be passed to return the <em>Apache::Upload</em>
object associated with the given name:</p>
<pre>
    my $upload = $apr-&gt;upload($name);</pre>
<p>
</p>
<hr />
<h1><a name="subclassing_apache::request">SUBCLASSING Apache::Request</a></h1>
<p>If the instances of your subclass are hash references then you can actually
inherit from Apache::Request as long as the Apache::Request object is stored in
an attribute called ``r'' or ``_r''. (The Apache::Request class effectively does the
delegation for you automagically, as long as it knows where to find the
Apache::Request object to delegate to.)  For example:</p>
<pre>
        package MySubClass;
        use Apache::Request;
        our @ISA = qw(Apache::Request);
        sub new {
                my($class, @args) = @_;
                return bless { r =&gt; Apache::Request-&gt;new(@args) }, $class;
        }</pre>
<p>
</p>
<hr />
<h1><a name="apache::upload_methods">Apache::Upload METHODS</a></h1>
<p>
</p>
<h2><a name="name">name</a></h2>
<p>The name of the filefield parameter:</p>
<pre>
    my $name = $upload-&gt;name;</pre>
<p>
</p>
<h2><a name="filename">filename</a></h2>
<p>The filename of the uploaded file:</p>
<pre>
    my $filename = $upload-&gt;filename;</pre>
<p>
</p>
<h2><a name="bb_[replaces_fh]">bb [replaces fh]</a></h2>
<p>The APR::Brigade containing the contents of the uploaded file.</p>
<p>
</p>
<h2><a name="size_[todo]">size [TODO]</a></h2>
<p>The size of the file in bytes:</p>
<pre>
    my $size = $upload-&gt;size;</pre>
<p>
</p>
<h2><a name="info">info</a></h2>
<p>The additional header information for the uploaded file.
Returns a hash reference tied to the <em>Apache::Table</em> class.
An optional <em>key</em> argument can be passed to return the value of 
a given header rather than a hash reference.  Examples:</p>
<pre>
    my $info = $upload-&gt;info;
    while (my($key, $val) = each %$info) {
        ...
    }</pre>
<pre>
    my $val = $upload-&gt;info(&quot;Content-type&quot;);</pre>
<p>
</p>
<h2><a name="type_[todo]">type [TODO]</a></h2>
<p>Returns the <em>Content-Type</em> for the given <em>Apache::Upload</em> object:</p>
<pre>
    my $type = $upload-&gt;type;
    #same as
    my $type = $upload-&gt;info(&quot;Content-Type&quot;);</pre>
<p>
</p>
<h2><a name="tempname_[xxx_does_this_mesh_with_brigade_api]">tempname [XXX- Does this mesh with brigade API?]</a></h2>
<p>Provides the name of the spool file. This method is reserved for
debugging purposes, and is possibly subject to change in a future
version of Apache::Request.</p>
<p>
</p>
<h2><a name="link">link</a></h2>
<p>To avoid recopying the upload's internal tempfile brigade on a 
*nix-like system, <em>link</em> will create a hard link to it:</p>
<pre>
  my $upload = $apr-&gt;upload('file');
  $upload-&gt;link(&quot;/path/to/newfile&quot;) or
      die sprintf &quot;link from '%s' failed: $!&quot;, $upload-&gt;tempname;</pre>
<p>Typically the new name must lie on the same file system as the
brigade's tempfile. Check your system's <code>link(2)</code> manpage for details.</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>APR::Table(3)</p>
<p>
</p>
<hr />
<h1><a name="credits">CREDITS</a></h1>
<p>This interface is based on the original pure Perl version by Lincoln Stein.</p>
<p>
</p>
<hr />
<h1><a name="authors">AUTHORS</a></h1>
<p>Doug MacEachern, Joe Schaefer, Steve Hay.</p>
<p>
</p>
<hr />
<h1><a name="missing_docs">MISSING DOCS</a></h1>
<p>$req-&gt;config, Apache::Request::Table, Apache::Upload::Table.</p>

 <hr><address style="align: right;"><small>Generated on Sat Nov 15 23:04:50 2003 for libapreq2 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3 </small></address>
</body>
</html>
